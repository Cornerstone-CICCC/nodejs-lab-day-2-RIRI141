<h1>Log In</h1>
<form id="login-form">
  <label>
    Username:
    <input
      id="username"
      type="text"
      name="username"
      placeholder="Enter username"
      required
    />
  </label>
  <label>
    Password:
    <input
      id="password"
      type="password"
      name="password"
      placeholder="Enter password"
      required
    />
  </label>
  <button type="submit">Log In</button>
</form>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const loginForm = document.querySelector("#login-form");

    if (loginForm) {
      loginForm.addEventListener("submit", async (event) => {
        event.preventDefault();

        const username = document.querySelector(
          "#username"
        ) as HTMLInputElement;
        const password = document.querySelector(
          "#password"
        ) as HTMLInputElement;

        if (username && password) {
          const res = await fetch("http://localhost:4000/login", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              username: username.value,
              password: password.value,
            }),
            credentials: "include",
          });
          if (res.ok) {
            window.location.href = "/profile";
          }
        }
      });
    }
  });
</script>
